{"version":3,"file":"bundle.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\ndocument.addEventListener('DOMContentLoaded', init);\n\nfunction init() {\n  if (DEV_MODE) console.warn('Running in DEV Mode');\n  document.addEventListener('mouseup', eventManager);\n  App.initAlbum();\n}\n\nfunction eventManager(event) {\n  const { target } = event;\n  const action = target.dataset['action'] || false;\n  if (action) actionDispatcher(action);\n}\n\nfunction actionDispatcher(action) {\n  if (DEV_MODE) console.info(action);\n\n  switch (action) {\n    case 'Open Panel Info':\n      Slider.pause();\n      Panel.closeAllPanels();\n      Panel.open(Panel.panelInfo);\n      break;\n\n    case 'Abrir Panel Slider':\n      Slider.play();\n      Panel.closeAllPanels();\n      Panel.open(Panel.panelSlider);\n      toggleFullScreen();\n      break;\n\n    case 'Open Panel Gallery':\n      Slider.pause();\n      Panel.closeAllPanels();\n      Panel.open(Panel.panelGallery);\n      break;\n\n    case 'Open Image Options':\n      Slider.pause();\n      Panel.open(Panel.panelImageOptions);\n      break;\n\n    case 'Close Image Options':\n      Panel.close(Panel.panelImageOptions);\n      Slider.play();\n      break;\n\n    case 'Próxima imágen':\n      Slider.forward();\n      break;\n\n    case 'Imágen previa':\n      Slider.backward();\n      break;\n\n    case 'Saltar a imágen':\n      const image = Number(event.target.dataset.image);\n      actionDispatcher('Abrir Panel Slider');\n      Slider.changeImage(image);\n      Slider.play();\n\n      break;\n\n    case 'Continuar la reproducción':\n      actionDispatcher('Close Image Options');\n      Slider.play();\n      break;\n\n    case 'Pausar la reproducción':\n      Slider.pause();\n      break;\n\n    case 'Compartir en Facebook':\n      shareTo('Facebook');\n      actionDispatcher('Close Image Options');\n      break;\n\n    case 'Compartir en Whatsapp':\n      shareTo('WhatsApp');\n      actionDispatcher('Close Image Options');\n      break;\n\n    case 'Descargar Imágen':\n      const src = App.album.image_src + App.album.slider.actual + App.album.cfgImgType;\n      downloadCurrentImage(src);\n      actionDispatcher('Close Image Options');\n      break;\n    case 'Cambiar a Pantalla Completa':\n      toggleFullScreen();\n      actionDispatcher('Close Image Options');\n      break;\n\n    default:\n      break;\n  }\n}\n\nconst Slider = {\n  container: document.getElementById('slider-image'),\n  intervalID: null,\n\n  timerStart() {\n    const { rate } = App.album.slider;\n    App.album.slider.status = true;\n    this.intervalID = setInterval(() => {\n      this.forward();\n    }, rate);\n  },\n\n  timerPause() {\n    for (var i = 1; i <= this.intervalID; i++) {\n      clearInterval(i);\n    }\n  },\n\n  play() {\n    this.timerStart();\n  },\n  pause() {\n    this.timerPause();\n  },\n  toggle() {\n    console.log(arguments.callee.name);\n  },\n\n  forward() {\n    let current = App.album.slider.actual;\n    const last = App.album.cantidadFotos;\n    next = current < last ? current + 1 : 1;\n    this.changeImage(next);\n  },\n\n  backward() {\n    let current = App.album.slider.actual;\n    const last = App.album.cantidadFotos;\n    next = current === 1 ? last : current - 1;\n    this.changeImage(next);\n  },\n\n  changeImage(image) {\n    const { image_src: path, cfgImgType: type } = App.album;\n    const src = path + image + type;\n    App.album.slider.actual = image;\n\n    if (DEV_MODE) console.info(src);\n    this.container.setAttribute('src', src);\n  },\n};\n\nconst Panel = {\n  panelInfo: document.querySelector('.panel-info'),\n  panelSlider: document.querySelector('.panel-slider'),\n  panelImageOptions: document.querySelector('.panel-slider__options'),\n  panelGallery: document.querySelector('.panel-gallery'),\n\n  switchTo(panel) {\n    this.closeAllPanels();\n    this.open(panel);\n  },\n\n  open(panel) {\n    panel.classList.add('active');\n  },\n  close(panel) {\n    panel.classList.remove('active');\n  },\n\n  closeAllPanels() {\n    this.panelInfo.classList.remove('active');\n    this.panelSlider.classList.remove('active');\n    this.panelGallery.classList.remove('active');\n  },\n};\n\nconst App = {\n  album: {},\n\n  async initAlbum() {\n    try {\n      const url = '../site/database/database.json';\n      const response = await fetch(url);\n      if (!response.ok) throw Error('No se puede cargar la bases de datos desde: ' + url);\n      const data = await response.json();\n      albumId = this.getAlbumId();\n      const album = data.albumes[albumId] || false;\n\n      if (!album || !album.autor) throw Error(`No existe el Album ${albumId}`);\n      const autor = data.autores[album.autor];\n      if (!autor.nombre) throw Error(`No existe el Autor ${album.autor}`);\n      if (!album.activo)\n        throw Error(\n          'El álbum solicitado está inactivo, por favor contáctese al teléfono +54 381 5900868'\n        );\n\n      // Add autor\n      album.autor = autor;\n\n      // Add image_src\n      album.image_src = album.cfgAlbumUrl + album.cfgImgUrl;\n\n      // Add cover\n      if (!album.cover) album.cover = `${album.image_src}3${album.cfgImgType}`;\n\n      // Add sliderStatus\n      album.slider = {\n        rate: album.cfgSliderTimer,\n        actual: 1,\n        vistas: 0,\n        status: false,\n      };\n\n      // Add album\n      this.album = album;\n\n      this.fillImageGallery();\n      this.fillInfoPanel();\n      this.loadBackgroundImage();\n      if (DEV_MODE) console.info('Loading Album', album);\n    } catch (error) {\n      this.showErrorMessage(String(error).replace('Error:', ''));\n      console.error(error);\n      return false;\n    }\n  },\n\n  getAlbumId() {\n    return location.pathname.replace(/\\//g, '');\n  },\n\n  loadBackgroundImage() {\n    Panel.panelInfo.style.background = `url(${this.album.cover})`;\n  },\n\n  fillInfoPanel() {\n    const {\n      evento,\n      fechaEvento: fecha,\n      lugar,\n      cantidadFotos: fotos,\n      cfgSliderTimer: timer,\n    } = this.album;\n    const { nombre: autor, web, tel, mail: email } = this.album.autor;\n    const parseDate = getParseDate(fecha);\n    const imageAndTime = `${fotos} imágenes, ${((fotos * timer) / (timer * 10)).toFixed(\n      1\n    )} minutos.`;\n\n    const container = document.querySelector('.panel-info__album-info');\n\n    container.children[0].textContent = evento;\n    container.children[1].textContent = parseDate;\n    container.children[2].textContent = lugar;\n    container.children[3].textContent = imageAndTime;\n    container.children[5].textContent = autor;\n    container.children[6].children[0].href = web;\n    container.children[6].children[0].textContent = web;\n    container.children[7].children[0].href = 'tel:' + tel;\n    container.children[7].children[0].textContent = tel;\n    container.children[8].children[0].href = 'mailto:' + email;\n    container.children[8].children[0].textContent = email;\n  },\n\n  fillImageGallery() {\n    const fragment = document.createDocumentFragment();\n\n    const renderImage = (image, src) => {\n      const element = document.createElement('img');\n      element.setAttribute('src', src);\n      element.setAttribute('alt', this.album.evento);\n      element.setAttribute('title', this.album.evento);\n      element.setAttribute('data-image', image);\n      element.setAttribute('data-action', 'Saltar a imágen');\n      return element;\n    };\n\n    const { image_src: path, cfgImgType: type } = this.album;\n    for (let index = 1; index <= this.album.cantidadFotos; index++) {\n      const src = path + index + type;\n      const image = renderImage(index, src);\n      fragment.appendChild(image);\n    }\n    Panel.panelGallery.appendChild(fragment);\n  },\n\n  showErrorMessage(msg) {\n    const container = document.querySelector('.panel-info__album-info');\n    container.innerHTML = `<h1>${msg}</h1>`;\n  },\n};\n\nfunction getParseDate() {\n  var options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };\n  var [day, month, year] = App.album.fechaEvento.split('/');\n\n  var date = new Date([year, month, day].join('-') + 'T01:01:01');\n\n  var fecha = new Date(date);\n\n  return date.toLocaleDateString('es-AR', options);\n}\n\nfunction shareTo(provider) {\n  console.log(provider);\n  let url = false;\n  switch (provider) {\n    case 'Facebook':\n      url = `https://www.facebook.com/sharer/sharer.php?u=${location.href}`;\n      break;\n\n    case 'WhatsApp':\n      url = `whatsapp://send?text=${location.href}`;\n      break;\n  }\n  if (url) window.open(url);\n}\n\n// Download current image\nfunction downloadCurrentImage(src) {\n  try {\n    const anchor = document.createElement('a');\n    anchor.href = src;\n    anchor.download = `${App.album.evento} - ${App.album.slider.actual}`;\n    anchor.setAttribute('target', '_blank');\n    console.log(anchor);\n    document.body.appendChild(anchor);\n    anchor.click();\n    anchor.remove();\n  } catch (error) {}\n}\n\nfunction toggleFullScreen() {\n  if (DEV_MODE) {\n    console.error('Fullscreen is disable in DEV MODE');\n    return false;\n  }\n\n  try {\n    if (!document.fullscreenElement) {\n      document.documentElement.requestFullscreen();\n    } else {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      }\n    }\n  } catch (error) {}\n}\n\n/**\n * IIFE function that check if run site in localhost\n *\n * Usage Example:\n *\n * if (DEV_MODE) console.info('Message to console');\n *\n */\n(() => {\n  // localhost\n  const URLs = ['localhost', '0.0.0.0', '192.168'];\n  if (!window) return false;\n  window.DEV_MODE = null;\n  window.DEV_MODE = !!URLs.filter((url) => {\n    const x = new RegExp(url, 'ig');\n    return x.test(location.href);\n  }).length;\n})();\n"],"names":["eventManager","event","target","action","dataset","actionDispatcher","DEV_MODE","console","info","Slider","pause","Panel","closeAllPanels","open","panelInfo","play","panelSlider","toggleFullScreen","panelGallery","panelImageOptions","close","forward","backward","image","Number","changeImage","shareTo","src","anchor","document","createElement","href","download","App","album","evento","slider","actual","setAttribute","log","body","appendChild","click","remove","error","downloadCurrentImage","image_src","cfgImgType","addEventListener","warn","initAlbum","container","getElementById","intervalID","[object Object]","rate","status","this","setInterval","i","clearInterval","timerStart","timerPause","arguments","callee","name","current","last","cantidadFotos","next","path","type","querySelector","panel","classList","add","url","response","fetch","ok","Error","data","json","albumId","getAlbumId","albumes","autor","autores","nombre","activo","cfgAlbumUrl","cfgImgUrl","cover","cfgSliderTimer","vistas","fillImageGallery","fillInfoPanel","loadBackgroundImage","showErrorMessage","String","replace","location","pathname","style","background","fechaEvento","fecha","lugar","fotos","timer","web","tel","mail","email","parseDate","options","weekday","year","month","day","split","Date","join","toLocaleDateString","getParseDate","imageAndTime","toFixed","children","textContent","fragment","createDocumentFragment","renderImage","element","index","msg","innerHTML","provider","window","fullscreenElement","exitFullscreen","documentElement","requestFullscreen","filter","RegExp","test","length"],"mappings":"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"}